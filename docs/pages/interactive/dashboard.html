---
layout: AURA-MF
title: AURA-MF Interactive Dashboard
---
<script src="https://polyfill.io"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net"></script>

    <main>
        
        <div class="hero-banner">
            <h2>üìä Real-Time PV Simulation Dashboard</h2>
            <p>Visualize multi-fidelity orchestration in real-time</p>
        </div>

        
        <h2>Overview</h2>

        <p>This dashboard provides <strong>real-time visualization</strong> of AURA-MFP's multi-fidelity simulation engine as it 
        processes photovoltaic thermal data. The interface displays:</p>

        <ul>
            <li>Live temperature field evolution ($T(\mathbf{x}, t)$)</li>
            <li>Fidelity level transitions (LF ‚Üí MF ‚Üí HF)</li>
            <li>Computational cost tracking</li>
            <li>Energy balance residuals</li>
            <li>ML orchestrator decision confidence</li>
        </ul>

        <h2>Dashboard Components</h2>

        
        <div class="feature-grid">
            <div class="feature-card">
                <h4>üå°Ô∏è Temperature Field</h4>
                <p>Display 2D heatmap of panel surface temperature distribution with perceptually-uniform colormap:</p>
                <p style="text-align: center; margin: 1rem 0;">
                    $$T(x, y, t) : [0, L_x] \times [0, L_y] \rightarrow \mathbb{R}^+$$
                </p>
                <p><strong>Resolution adapts to fidelity:</strong></p>
                <ul style="font-size: 0.9rem;">
                    <li>LF: $25 \times 25$ (6.4 cm spacing)</li>
                    <li>MF: $50 \times 50$ (3.2 cm spacing)</li>
                    <li>HF: $100 \times 100$ (1.6 cm spacing)</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>‚ö° Fidelity Timeline</h4>
                <p>Gantt chart showing fidelity level at each timestep:</p>
                <p style="text-align: center; margin: 1rem 0;">
                    $$\text{Fidelity}(t) \in \{0, 1, 2\}$$
                </p>
                <p><strong>Key metrics:</strong></p>
                <ul style="font-size: 0.9rem;">
                    <li>Cumulative HF usage percentage</li>
                    <li>Switching frequency</li>
                    <li>Speedup factor vs. pure HF</li>
                </ul>
            </div>
            

            <div class="feature-card">
                <h4>üîã Energy Balance Monitor</h4>
                <p>Verify thermodynamic consistency:</p>
                <p style="text-align: center; margin: 1rem 0;">
                    $$\epsilon_E(t) = \frac{\left| Q^* - [Q_H + Q_E + Q_G] \right|}{Q^*} \times 100\%$$
                </p>
                <p><strong>Alert thresholds:</strong></p>
                <ul style="font-size: 0.9rem;">
                    <li>Green: $\epsilon_E < 1\%$ (excellent)</li>
                    <li>Yellow: $1\% \leq \epsilon_E < 3\%$</li>
                    <li>Red: $\epsilon_E \geq 3\%$ (poor)</li>
                </ul>
            </div>

            <div class="feature-card">
                <h4>ü§ñ ML Decision Confidence</h4>
                <p>Q-value distribution for current state:</p>
                <p style="text-align: center; margin: 1rem 0;">
                    $$Q_\theta(\mathbf{s}_t, a) \quad \forall a \in \{0,1,2\}$$
                </p>
                <p><strong>Confidence metric:</strong></p>
                <p style="text-align: center; margin: 0.5rem 0;">
                    $$\frac{q_{\max} - q_{\text{2nd}}}{q_{\max}} \times 100\%$$
                </p>
                <p style="font-size: 0.9rem;">Values > 50% indicate high certainty</p>
            </div>
        </div>
        

        <div class="theory-box">
            <h4>Meteorological Inputs:</h4>
            <ul>
                <li>$T_\infty$ ‚àà [273, 323] K (ambient temperature)</li>
                <li>$G$ ‚àà [0, 1200] W/m¬≤ (solar irradiance)</li>
                <li>$u_\infty$ ‚àà [0, 10] m/s (wind speed)</li>
                <li>$\theta_z$ ‚àà [0, 85]¬∞ (solar zenith angle)</li>
            </ul>

            <h4>Physical Properties:</h4>
            <ul>
                <li>$\epsilon$ ‚àà [0.7, 0.95] (surface emissivity)</li>
                <li>$\alpha$ ‚àà [0.8, 0.98] (solar absorptivity)</li>
                <li>$k_{\text{EVA}}$ ‚àà [0.3, 0.5] W/(m¬∑K) (encapsulant conductivity)</li>
            </ul>
        </div>

        <p>Each parameter change triggers <strong>immediate recalculation</strong> with current fidelity level, 
        allowing exploration of design space.</p>

        <h2>Technical Implementation</h2>

        <h3>Numerical Stability Indicator</h3>

        <p>Dashboard monitors <strong>Courant-Friedrichs-Lewy (CFL) condition</strong> for temporal stability:</p>

        <p style="text-align: center; margin: 2rem 0;">
            $$\text{CFL} = \frac{u_{\max} \Delta t}{\Delta x} + \frac{\alpha \Delta t}{\Delta x^2}$$
        </p>

        <p>where $\alpha = k / (\rho c_p)$ is thermal diffusivity.</p>

        <div class="info-box">
            <p><strong>Stability criterion:</strong> CFL $< 0.5$ (explicit schemes)</p>
            <p><strong>Alert:</strong> Red warning if CFL $> 0.9$ (risk of numerical instability)</p>
        </div>
            
        <div>
            {% include bte_ns_wrapper.html %}
        </div>

        <h2>Future Enhancements</h2>

        <h3>3D Volume Rendering</h3>

        <p>Extend temperature field visualization to full 3D volumetric rendering using ray-casting:</p>

        <p style="text-align: center; margin: 2rem 0;">
            $$C_{\text{pixel}} = \int_0^L \tau(\mathbf{x}(s)) \cdot T(\mathbf{x}(s), t) \cdot 
            e^{-\int_0^s \tau(\mathbf{x}(s')) ds'} ds$$
        </p>

        <h3>Predictive Analytics</h3>

        <p>Add <strong>10-minute forecast</strong> using trained LSTM model:</p>

        <p style="text-align: center; margin: 2rem 0;">
            $$\hat{T}(t + \Delta t_{\text{forecast}}) = \text{LSTM}(\{T(\tau), G(\tau), u(\tau)\}_{\tau=t-W:t})$$
        </p>

        <p>Display prediction interval: $[\hat{T} - 2\sigma_{\text{LSTM}}, \hat{T} + 2\sigma_{\text{LSTM}}]$</p>


        <div class="warning-box">
            <h3 style="margin-top: 0;">‚ö†Ô∏è Development in Progress</h3>
            <p>This dashboard is currently under active development. Full WebSocket integration and real-time rendering are 
            scheduled for <strong>Phase 3</strong> of the AURA-MFP roadmap (Q2 2026).</p>
        </div>

        <h2>References</h2>

        <ol>
            <li>Lorensen, W. E., & Cline, H. E. (1987). Marching cubes: A high resolution 3D surface construction algorithm. 
                <em>ACM SIGGRAPH Computer Graphics</em>, 21(4), 163-169.</li>
            <li>Munzner, T. (2014). <em>Visualization Analysis and Design</em>. CRC Press.</li>
            <li>Holten, D., & Van Wijk, J. J. (2009). Force-directed edge bundling for graph visualization. 
                <em>Computer Graphics Forum</em>, 28(3), 983-990.</li>
        </ol>

    
    <script>
      // Make config available globally for dashboard_scripts.js
      window.DASHBOARD_CONFIG = {
        API_BASE_URL: "https://aura-mf-backend.onrender.com"
      };
    </script>
    <!--<script src="https://thmscmpg.github.io/backend-hub/assets/dashboard_scripts.js"></script>-->
    <script src="https://thmscmpg.github.io/backend-hub/assets/bte_ns_backend_integration.js"></script>
    <script>
        // Function to check if mobile sidebar is visible
        function isSidebarVisible() {
            const sidebar = document.getElementById("mobileSidebar");
            if (sidebar) {
                const isOpen = sidebar.classList.contains('open');
                return isOpen;
            }
        }

        // Additional UI enhancements
        document.addEventListener('DOMContentLoaded', function() {
            // Sync fidelity displays
            const originalUpdate = window.AURADashboard?.updateDashboard;
            if (originalUpdate) {
                window.AURADashboard.updateDashboard = function(data) {
                    originalUpdate(data);
                    
                    // Update secondary fidelity display
                    const fidelityLevel2 = document.getElementById('fidelityLevel2');
                    if (fidelityLevel2) {
                        fidelityLevel2.textContent = data.fidelity_name;
                        const colors = ['#4CAF50', '#FF9800', '#F44336'];
                        fidelityLevel2.style.color = colors[data.fidelity_level];
                    }
                };
            }
        });

        /**
 * BTE-NS Simulator Backend Integration (FIXED VERSION)
 * =====================================================
 * Enhanced with comprehensive logging and error handling
 * 
 * Version: 1.1.0 - Debug Edition
 */

(function() {
    'use strict';

    console.log('%cüöÄ BTE-NS Backend Integration v1.1.0 Loading...', 'color: #667eea; font-weight: bold');

    // ========================================================================
    // CONFIGURATION
    // ========================================================================

    const BTENS_CONFIG = {
        API_BASE_URL: 'https://aura-mf-backend.onrender.com',
        ENDPOINT: '/api/simulate/bte-ns',
        TIMEOUT: 60000,
        
        CANVASES: {
            temperature: 'temperature-canvas',
            current: 'power-canvas',
            velocity: 'velocity-canvas',
            phonon: 'phonon-canvas'
        }
    };

    // ========================================================================
    // STATE MANAGEMENT
    // ========================================================================

    class BTENSState {
        constructor() {
            this.isRunning = false;
            this.lastResults = null;
            this.simulationCount = 0;
            this.errorCount = 0;
        }
        
        recordSuccess(data) {
            this.lastResults = data;
            this.simulationCount++;
            this.errorCount = 0;
            console.log(`%c‚úÖ Simulation #${this.simulationCount} completed`, 'color: #4CAF50; font-weight: bold');
        }
        
        recordError() {
            this.errorCount++;
            console.error(`‚ùå Error count: ${this.errorCount}`);
        }
    }

    const btensState = new BTENSState();

    // ========================================================================
    // API COMMUNICATION
    // ========================================================================

    async function runBTENSSimulation() {
        console.group('üîÑ BTE-NS Simulation Starting');
        console.log('Timestamp:', new Date().toISOString());
        
        if (btensState.isRunning) {
            console.warn('‚ö†Ô∏è Simulation already running');
            console.groupEnd();
            return;
        }

        const runBtn = document.getElementById('run-simulation-btn');
        const statusDiv = document.getElementById('simulation-status');
        const resultsDiv = document.getElementById('results-panel');
        
        console.log('UI Elements:', {
            runBtn: !!runBtn,
            statusDiv: !!statusDiv,
            resultsDiv: !!resultsDiv
        });

        try {
            btensState.isRunning = true;
            
            if (runBtn) runBtn.disabled = true;
            if (statusDiv) {
                statusDiv.textContent = '‚è≥ Running coupled BTE-NS simulation...';
                statusDiv.style.color = '#FF9800';
            }

            const params = collectParameters();
            console.log('üìä Parameters collected:', params);

            const url = `${BTENS_CONFIG.API_BASE_URL}${BTENS_CONFIG.ENDPOINT}`;
            console.log('üì° Sending request to:', url);

            const controller = new AbortController();
            const timeoutId = setTimeout(() => {
                console.error('‚è±Ô∏è Request timeout');
                controller.abort();
            }, BTENS_CONFIG.TIMEOUT);

            const requestBody = JSON.stringify(params);
            console.log('üì§ Request body length:', requestBody.length);

            const response = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: requestBody,
                signal: controller.signal
            });

            clearTimeout(timeoutId);

            console.log('üì• Response received:', {
                status: response.status,
                statusText: response.statusText,
                ok: response.ok,
                headers: {
                    contentType: response.headers.get('content-type'),
                    contentLength: response.headers.get('content-length')
                }
            });

            if (!response.ok) {
                const errorText = await response.text();
                console.error('‚ùå Server error response:', errorText);
                throw new Error(`Server error ${response.status}: ${errorText.substring(0, 200)}`);
            }

            const data = await response.json();
            console.log('‚úÖ Data parsed successfully');
            console.log('üìä Response structure:', {
                success: data.success,
                hasVisualizations: !!data.visualizations,
                hasStatistics: !!data.statistics,
                fidelityLevel: data.fidelity_level,
                runtime: data.runtime_ms
            });

            if (data.visualizations) {
                console.log('üé® Visualizations present:', {
                    temperature: !!data.visualizations.temperature_heatmap,
                    current: !!data.visualizations.current_density,
                    velocity: !!data.visualizations.velocity_field
                });
            }

            btensState.recordSuccess(data);

            console.log('üé® Updating visualizations...');
            const vizResult = updateVisualizations(data);
            console.log('Visualization update result:', vizResult);

            console.log('üìà Updating statistics...');
            updateStatistics(data);

            if (resultsDiv) {
                resultsDiv.style.display = 'block';
                console.log('‚úÖ Results panel shown');
            }

            if (statusDiv) {
                statusDiv.textContent = `‚úÖ Simulation completed in ${data.runtime_ms.toFixed(1)}ms`;
                statusDiv.style.color = '#4CAF50';
            }

            console.log('%c‚úÖ SIMULATION COMPLETE', 'color: #4CAF50; font-weight: bold; font-size: 14px');

        } catch (error) {
            console.error('%c‚ùå SIMULATION FAILED', 'color: #F44336; font-weight: bold; font-size: 14px');
            console.error('Error details:', error);
            console.error('Error stack:', error.stack);
            
            btensState.recordError();
            
            let errorMessage = error.message;
            if (error.name === 'AbortError') {
                errorMessage = 'Simulation timeout (>60s). Try reducing fidelity level.';
            } else if (errorMessage.includes('Failed to fetch')) {
                errorMessage = 'Cannot connect to backend. Check network connection.';
            }
            
            console.error('User-facing error:', errorMessage);
            
            if (statusDiv) {
                statusDiv.textContent = `‚ùå Error: ${errorMessage}`;
                statusDiv.style.color = '#F44336';
            }
            
            alert(`Simulation Error:\n\n${errorMessage}\n\nCheck browser console (F12) for details.`);
            
        } finally {
            btensState.isRunning = false;
            if (runBtn) runBtn.disabled = false;
            console.groupEnd();
        }
    }

    // ========================================================================
    // PARAMETER COLLECTION
    // ========================================================================

    function collectParameters() {
        console.log('üìã Collecting parameters...');
        
        const fidelityBtns = document.querySelectorAll('.fidelity-btn');
        let fidelityLevel = 1;
        
        fidelityBtns.forEach((btn, index) => {
            if (btn.classList.contains('active')) {
                fidelityLevel = index;
                console.log(`  Fidelity: ${index} (${btn.textContent})`);
            }
        });

        const params = {
            fidelity_level: fidelityLevel,
            solar_irradiance: getElementValue('solar-irradiance', 1000),
            ambient_temperature: getElementValue('ambient-temperature', 298.15),
            wind_speed: getElementValue('wind-speed', 2.0),
            cell_efficiency: getElementValue('cell-efficiency', 0.20),
            thermal_conductivity: getElementValue('thermal-conductivity', 130),
            absorptivity: getElementValue('absorptivity', 0.95),
            emissivity: getElementValue('emissivity', 0.90)
        };

        console.log('  Parameters:', params);
        return params;
    }

    function getElementValue(id, defaultValue) {
        const element = document.getElementById(id);
        if (!element) {
            console.warn(`  ‚ö†Ô∏è Element #${id} not found, using default: ${defaultValue}`);
            return defaultValue;
        }
        const value = parseFloat(element.value);
        console.log(`  ${id}: ${value}`);
        return value;
    }

    // ========================================================================
    // VISUALIZATION UPDATES
    // ========================================================================

    function updateVisualizations(data) {
        console.group('üé® Updating Visualizations');
        
        if (!data.visualizations) {
            console.warn('‚ö†Ô∏è No visualizations in response');
            console.groupEnd();
            return { success: false, reason: 'no_visualizations' };
        }

        const viz = data.visualizations;
        const results = {};

        // Temperature heatmap
        if (viz.temperature_heatmap) {
            console.log('Drawing temperature heatmap...');
            results.temperature = displayBase64Image(
                BTENS_CONFIG.CANVASES.temperature, 
                viz.temperature_heatmap
            );
        } else {
            console.warn('‚ö†Ô∏è No temperature_heatmap in response');
        }

        // Current density
        if (viz.current_density) {
            console.log('Drawing current density...');
            results.current = displayBase64Image(
                BTENS_CONFIG.CANVASES.current, 
                viz.current_density
            );
        } else {
            console.warn('‚ö†Ô∏è No current_density in response');
        }

        // Velocity field
        if (viz.velocity_field) {
            console.log('Drawing velocity field...');
            results.velocity = displayBase64Image(
                BTENS_CONFIG.CANVASES.velocity, 
                viz.velocity_field
            );
        } else {
            console.warn('‚ö†Ô∏è No velocity_field in response');
        }

        console.log('Results:', results);
        console.groupEnd();
        
        return results;
    }

    function displayBase64Image(canvasId, base64Data) {
        console.log(`  Canvas: #${canvasId}`);
        
        const canvas = document.getElementById(canvasId);
        if (!canvas) {
            console.error(`  ‚ùå Canvas #${canvasId} not found in DOM`);
            return { success: false, reason: 'canvas_not_found' };
        }

        console.log(`  ‚úÖ Canvas found: ${canvas.width}x${canvas.height}`);

        const ctx = canvas.getContext('2d');
        if (!ctx) {
            console.error('  ‚ùå Cannot get 2D context');
            return { success: false, reason: 'no_context' };
        }

        if (!base64Data) {
            console.error('  ‚ùå No base64 data provided');
            return { success: false, reason: 'no_data' };
        }

        console.log(`  Base64 data length: ${base64Data.length}`);
        console.log(`  Starts with: ${base64Data.substring(0, 50)}...`);

        return new Promise((resolve) => {
            const img = new Image();

            img.onload = function() {
                console.log(`  ‚úÖ Image loaded: ${img.width}x${img.height}`);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                console.log('  ‚úÖ Image drawn on canvas');
                resolve({ success: true });
            };

            img.onerror = function(e) {
                console.error('  ‚ùå Image load error:', e);
                console.error('  Data URL check:', {
                    hasDataPrefix: base64Data.startsWith('data:image'),
                    length: base64Data.length
                });
                
                // Draw error indicator
                ctx.fillStyle = '#f8f9fa';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#F44336';
                ctx.font = 'bold 16px Arial';
                ctx.textAlign = 'center';
                ctx.fillText('Image Load Error', canvas.width / 2, canvas.height / 2);
                ctx.font = '12px Arial';
                ctx.fillText('Check console for details', canvas.width / 2, canvas.height / 2 + 20);
                
                resolve({ success: false, reason: 'image_load_error' });
            };

            img.src = base64Data;
        });
    }

    // ========================================================================
    // STATISTICS UPDATES
    // ========================================================================

    function updateStatistics(data) {
        console.group('üìà Updating Statistics');
        
        if (!data.statistics) {
            console.warn('‚ö†Ô∏è No statistics in response');
            console.groupEnd();
            return;
        }

        const stats = data.statistics;
        console.log('Statistics:', stats);

        updateElement('max-temp-value', `${stats.temp_max} ¬∞C`);
        updateElement('min-temp-value', `${stats.temp_min} ¬∞C`);
        updateElement('avg-temp-value', `${stats.temp_avg} ¬∞C`);
        updateElement('power-total-value', `${stats.power_total} W`);
        updateElement('efficiency-value', `${stats.efficiency_avg} %`);
        updateElement('current-density-value', `${stats.current_density_max} A/m¬≤`);
        updateElement('velocity-max-value', `${stats.velocity_max} m/s`);
        updateElement('carrier-density-value', stats.carrier_density_avg);
        updateElement('fidelity-display', data.fidelity_name);
        updateElement('runtime-display', `${data.runtime_ms.toFixed(1)} ms`);

        console.groupEnd();
    }

    function updateElement(elementId, value) {
        const element = document.getElementById(elementId);
        if (element) {
            element.textContent = value;
            console.log(`  ‚úÖ #${elementId} = ${value}`);
        } else {
            console.log(`  ‚ö†Ô∏è #${elementId} not found`);
        }
    }

    // ========================================================================
    // INITIALIZATION
    // ========================================================================

    function initializeBTENS() {
        console.group('üöÄ BTE-NS Initialization');
        console.log('API Endpoint:', BTENS_CONFIG.API_BASE_URL + BTENS_CONFIG.ENDPOINT);
        console.log('Timeout:', BTENS_CONFIG.TIMEOUT + 'ms');

        const runBtn = document.getElementById('run-simulation-btn');
        if (runBtn) {
            runBtn.addEventListener('click', runBTENSSimulation);
            console.log('‚úÖ Run button (#run-simulation-btn) event attached');
        } else {
            console.error('‚ùå Run button (#run-simulation-btn) NOT FOUND');
        }

        // Verify canvases
        console.log('Canvas check:');
        for (let [name, id] of Object.entries(BTENS_CONFIG.CANVASES)) {
            const canvas = document.getElementById(id);
            if (canvas) {
                console.log(`  ‚úÖ ${name}: ${canvas.width}x${canvas.height}`);
            } else {
                console.error(`  ‚ùå ${name} (#${id}) not found`);
            }
        }

        // Health check
        fetch(`${BTENS_CONFIG.API_BASE_URL}/api/health`)
            .then(response => response.json())
            .then(data => {
                console.log('‚úÖ Backend health check passed:', data);
            })
            .catch(error => {
                console.warn('‚ö†Ô∏è Backend health check failed:', error.message);
            });

        console.groupEnd();
    }

    // ========================================================================
    // GLOBAL API
    // ========================================================================

    window.BTENSSimulator = {
        run: runBTENSSimulation,
        getState: () => btensState,
        getLastResults: () => btensState.lastResults,
        config: BTENS_CONFIG,
        _displayBase64Image: displayBase64Image  // For debugging
    };

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeBTENS);
    } else {
        initializeBTENS();
    }

    console.log('%c‚úÖ BTE-NS Backend Integration v1.1.0 Loaded', 'color: #4CAF50; font-weight: bold');

})();

/**
 * BTE-NS Simulator Debug Console
 * ================================
 * Comprehensive debugging tool to identify why simulations aren't working
 * 
 * Usage: Add this script AFTER bte_ns_backend_integration.js
 * Open browser console and check for diagnostic messages
 */

 (function() {
    'use strict';

    console.log('%cüîç BTE-NS Debug Console Starting...', 'color: #00ff00; font-weight: bold; font-size: 14px');

    // ========================================================================
    // DIAGNOSTIC CHECKS
    // ========================================================================

    const diagnostics = {
        checks: [],
        errors: [],
        warnings: []
    };

    function addCheck(name, status, message) {
        const result = { name, status, message };
        diagnostics.checks.push(result);
        
        const emoji = status === 'pass' ? '‚úÖ' : status === 'fail' ? '‚ùå' : '‚ö†Ô∏è';
        const color = status === 'pass' ? '#4CAF50' : status === 'fail' ? '#F44336' : '#FF9800';
        
        console.log(`%c${emoji} ${name}`, `color: ${color}`, message || '');
        
        if (status === 'fail') diagnostics.errors.push(result);
        if (status === 'warn') diagnostics.warnings.push(result);
    }

    // ========================================================================
    // CHECK 1: Backend Integration Script Loaded
    // ========================================================================

    if (typeof window.BTENSSimulator !== 'undefined') {
        addCheck('Backend Integration', 'pass', 'BTENSSimulator object found');
    } else {
        addCheck('Backend Integration', 'fail', 'BTENSSimulator not found - script may not be loaded');
    }

    // ========================================================================
    // CHECK 2: Required DOM Elements
    // ========================================================================

    const requiredElements = {
        'Run Button': 'run-simulation-btn',
        'Temperature Canvas': 'temperature-canvas',
        'Power/Current Canvas': 'power-canvas',
        'Velocity Canvas': 'velocity-canvas',
        'Status Display': 'simulation-status'
    };

    console.group('üìã DOM Element Check');
    for (let [name, id] of Object.entries(requiredElements)) {
        const element = document.getElementById(id);
        if (element) {
            addCheck(name, 'pass', `Found #${id}`);
            console.log('  Element:', element);
        } else {
            addCheck(name, 'fail', `Missing #${id}`);
        }
    }
    console.groupEnd();

    // ========================================================================
    // CHECK 3: Parameter Inputs
    // ========================================================================

    const parameterInputs = [
        'solar-irradiance',
        'ambient-temperature',
        'wind-speed',
        'cell-efficiency',
        'thermal-conductivity',
        'absorptivity',
        'emissivity'
    ];

    console.group('üéöÔ∏è Parameter Input Check');
    let foundInputs = 0;
    for (let id of parameterInputs) {
        const element = document.getElementById(id);
        if (element) {
            foundInputs++;
            console.log(`‚úÖ #${id}: value=${element.value}`);
        } else {
            console.warn(`‚ö†Ô∏è Missing #${id}`);
        }
    }
    addCheck('Parameter Inputs', foundInputs === parameterInputs.length ? 'pass' : 'warn', 
             `${foundInputs}/${parameterInputs.length} inputs found`);
    console.groupEnd();

    // ========================================================================
    // CHECK 4: Canvas Context Support
    // ========================================================================

    console.group('üé® Canvas Context Check');
    const testCanvas = document.getElementById('temperature-canvas');
    if (testCanvas) {
        try {
            const ctx = testCanvas.getContext('2d');
            if (ctx) {
                addCheck('Canvas 2D Context', 'pass', 'Can create 2D context');
                console.log('  Canvas size:', testCanvas.width, 'x', testCanvas.height);
            } else {
                addCheck('Canvas 2D Context', 'fail', 'Cannot create 2D context');
            }
        } catch (e) {
            addCheck('Canvas 2D Context', 'fail', 'Error: ' + e.message);
        }
    }
    console.groupEnd();

    // ========================================================================
    // CHECK 5: Backend API Accessibility
    // ========================================================================

    console.group('üåê Backend API Check');
    const apiUrl = window.BTENSSimulator?.config?.API_BASE_URL || 'https://aura-mf-backend.onrender.com';
    console.log('Testing API at:', apiUrl);

    fetch(`${apiUrl}/api/health`, { method: 'GET' })
        .then(response => response.json())
        .then(data => {
            addCheck('Backend Health', 'pass', 'Backend is reachable');
            console.log('  Backend version:', data.version);
            console.log('  Endpoints:', data.endpoints);
        })
        .catch(error => {
            addCheck('Backend Health', 'fail', 'Cannot reach backend: ' + error.message);
        })
        .finally(() => console.groupEnd());

    // ========================================================================
    // CHECK 6: Event Listeners
    // ========================================================================

    console.group('üëÇ Event Listener Check');
    const runBtn = document.getElementById('run-simulation-btn');
    if (runBtn) {
        const listeners = getEventListeners ? getEventListeners(runBtn) : null;
        if (listeners && listeners.click && listeners.click.length > 0) {
            addCheck('Run Button Listener', 'pass', `${listeners.click.length} click listener(s) attached`);
        } else {
            addCheck('Run Button Listener', 'warn', 'Cannot verify listeners (use Chrome DevTools)');
        }
    }
    console.groupEnd();

    // ========================================================================
    // CHECK 7: Console Error Detection
    // ========================================================================

    const originalConsoleError = console.error;
    let errorCount = 0;
    console.error = function(...args) {
        errorCount++;
        originalConsoleError.apply(console, ['üî¥ INTERCEPTED ERROR:', ...args]);
        diagnostics.errors.push({ name: 'Console Error', message: args.join(' ') });
    };

    // ========================================================================
    // INTERCEPT FETCH REQUESTS
    // ========================================================================

    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        const url = args[0];
        console.log(`%cüì° FETCH REQUEST`, 'color: #2196F3; font-weight: bold', url);
        
        return originalFetch.apply(this, args)
            .then(response => {
                const status = response.ok ? '‚úÖ' : '‚ùå';
                console.log(`%c${status} FETCH RESPONSE`, 
                    `color: ${response.ok ? '#4CAF50' : '#F44336'}; font-weight: bold`,
                    url, 'Status:', response.status);
                return response;
            })
            .catch(error => {
                console.error('‚ùå FETCH ERROR:', url, error);
                throw error;
            });
    };

    // ========================================================================
    // MANUAL TEST FUNCTION
    // ========================================================================

    window.debugBTENS = {
        // Run full diagnostic
        runDiagnostic: function() {
            console.clear();
            console.log('%cüîç Running Full Diagnostic...', 'color: #00ff00; font-weight: bold; font-size: 16px');
            location.reload();
        },

        // Test simulation manually
        testSimulation: async function() {
            console.log('%cüß™ Testing Simulation Manually...', 'color: #2196F3; font-weight: bold');
            
            const params = {
                fidelity_level: 1,
                solar_irradiance: 1000,
                ambient_temperature: 298.15,
                wind_speed: 2.0,
                cell_efficiency: 0.20,
                thermal_conductivity: 130,
                absorptivity: 0.95,
                emissivity: 0.90
            };
            
            console.log('Parameters:', params);
            
            try {
                const response = await fetch('https://aura-mf-backend.onrender.com/api/simulate/bte-ns', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(params)
                });
                
                console.log('Response status:', response.status);
                
                const data = await response.json();
                console.log('Response data:', data);
                
                if (data.visualizations) {
                    console.log('‚úÖ Visualizations received:');
                    console.log('  - Temperature:', data.visualizations.temperature_heatmap ? 'YES' : 'NO');
                    console.log('  - Current:', data.visualizations.current_density ? 'YES' : 'NO');
                    console.log('  - Velocity:', data.visualizations.velocity_field ? 'YES' : 'NO');
                    
                    // Try to display on canvas
                    this.displayTestImage('temperature-canvas', data.visualizations.temperature_heatmap);
                }
                
                return data;
                
            } catch (error) {
                console.error('‚ùå Test failed:', error);
                return null;
            }
        },

        // Display test image
        displayTestImage: function(canvasId, base64Data) {
            const canvas = document.getElementById(canvasId);
            if (!canvas) {
                console.error(`Canvas #${canvasId} not found`);
                return;
            }
            
            console.log(`Attempting to draw on #${canvasId}...`);
            
            const ctx = canvas.getContext('2d');
            const img = new Image();
            
            img.onload = function() {
                console.log('‚úÖ Image loaded successfully');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                console.log('‚úÖ Image drawn on canvas');
            };
            
            img.onerror = function(e) {
                console.error('‚ùå Image load failed:', e);
            };
            
            console.log('Setting image source (length:', base64Data?.length, ')');
            img.src = base64Data;
        },

        // Check if BTENSSimulator is working
        checkSimulator: function() {
            console.log('BTENSSimulator:', window.BTENSSimulator);
            if (window.BTENSSimulator) {
                console.log('Config:', window.BTENSSimulator.config);
                console.log('State:', window.BTENSSimulator.getState());
                console.log('Last Results:', window.BTENSSimulator.getLastResults());
            }
        },

        // Get summary
        getSummary: function() {
            console.log('\n%c‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'color: #667eea');
            console.log('%cüîç DIAGNOSTIC SUMMARY', 'color: #667eea; font-weight: bold; font-size: 16px');
            console.log('%c‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê', 'color: #667eea');
            
            console.log(`\n‚úÖ Passed: ${diagnostics.checks.filter(c => c.status === 'pass').length}`);
            console.log(`‚ö†Ô∏è  Warnings: ${diagnostics.warnings.length}`);
            console.log(`‚ùå Errors: ${diagnostics.errors.length}`);
            
            if (diagnostics.errors.length > 0) {
                console.log('\n%c‚ùå Critical Issues:', 'color: #F44336; font-weight: bold');
                diagnostics.errors.forEach(e => console.log(`  - ${e.name}: ${e.message}`));
            }
            
            if (diagnostics.warnings.length > 0) {
                console.log('\n%c‚ö†Ô∏è  Warnings:', 'color: #FF9800; font-weight: bold');
                diagnostics.warnings.forEach(w => console.log(`  - ${w.name}: ${w.message}`));
            }
            
            console.log('\n%c‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n', 'color: #667eea');
            
            return diagnostics;
        }
    };

    // ========================================================================
    // AUTO-RUN SUMMARY
    // ========================================================================

    setTimeout(() => {
        window.debugBTENS.getSummary();
        
        console.log('\n%cüí° DEBUGGING COMMANDS:', 'color: #2196F3; font-weight: bold; font-size: 14px');
        console.log('  debugBTENS.testSimulation()  - Test API call manually');
        console.log('  debugBTENS.checkSimulator()   - Check BTENSSimulator status');
        console.log('  debugBTENS.getSummary()       - Show diagnostic summary');
        console.log('  debugBTENS.runDiagnostic()    - Re-run full diagnostic\n');
    }, 2000);

})();
    </script>
    </main>
